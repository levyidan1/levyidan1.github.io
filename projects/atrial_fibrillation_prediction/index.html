<!DOCTYPE html>
<!-- _layouts/distill.html -->
<html>
  <head>    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Idan  Levy | Atrial Fibrillation Prediction</title>
    <meta name="author" content="Idan  Levy" />
    <meta name="description" content="This page describes the work we achieved in this research." />


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous" />

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light" />

    <!-- Styles -->
    
    <link rel="shortcut icon" href="/assets/img/%F0%9F%91%A8%E2%80%8D%F0%9F%92%BB"/>
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://levyidan1.github.io/projects/atrial_fibrillation_prediction/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark" />

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    


    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    <!-- Distill js -->
    <script src="/assets/js/distillpub/template.v2.js"></script>
    <script src="/assets/js/distillpub/transforms.v2.js"></script>
    
    <!-- Page/Post style -->
    <style type="text/css">
      .fake-img {
  background: #bbb;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 0px 4px rgba(0, 0, 0, 0.1);
  margin-bottom: 12px;
} .fake-img p {
  font-family: monospace;
  color: white;
  text-align: left;
  margin: 12px 0;
  text-align: center;
  font-size: 16px;
}

    </style>
  </head>

  <d-front-matter>
    <script async type="text/json">{
      "title": "Atrial Fibrillation Prediction",
      "description": "This page describes the work we achieved in this research.",
      "published": "March 23, 2022",
      "authors": [
        {
          "author": "Idan Levy",
          "authorURL": "https://idanlevy.com",
          "affiliations": [
            {
              "name": "Technion",
              "url": ""
            }
          ]
        },
        {
          "author": "Assaf Schuster",
          "authorURL": "https://assaf.net.technion.ac.il/",
          "affiliations": [
            {
              "name": "Technion",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter>

  <body class="fixed-top-navsticky-bottom-footer">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="https://levyidan1.github.io/"><span class="font-weight-bold">Idan</span>   Levy</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">about</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/research">research</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/teaching/">teaching</a>
              </li>

              <!-- Toogle theme mode -->
              <div class="toggle-container">
                <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </a>
              </div>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="post distill">

      <d-title>
        <h1>Atrial Fibrillation Prediction</h1>
        <p>This page describes the work we achieved in this research.</p>
      </d-title>

      <d-byline></d-byline>

      <d-article>
        <d-contents>
          <nav class="l-text figcaption">
          <h3>Contents</h3>
            <div><a href="#background">Background</a></div>
            <div><a href="#research-objective">Research Objective</a></div>
            <div><a href="#motivation">Motivation</a></div>
            <div><a href="#data">Data</a></div>
            <div><a href="#model">Model</a></div>
            <div><a href="#results">Results</a></div>
            <div><a href="#discussion">Discussion</a></div>
            
          </nav>
        </d-contents>

        <h2 id="background">Background</h2>

<p>Atrial fibrillation (AF) is an abnormal heart rhythm that affects more than 30 million
people worldwide. It is characterized by irregular and often very rapid rhythm.
AF is associated with an increased risk of death, stroke, and heart failure, and is
assumed to generate economic, clinical and societal challenges in the next decades.
Episodes of AF may come and go which can make it hard to diagnose. Treatment
options for AF are medications, cardioversion and surgery.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/AF-Episode-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/AF-Episode-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/AF-Episode-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/AF-Episode.png" title="ECG Signal of AF Episode">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    ECG Signal of an AF Episode.
</div>

<h2 id="research-objective">Research Objective</h2>

<p>Successfully predict if a patient is going to have an atrial fibrillation episode in the
next 30 minutes, only by looking at the patient’s raw ECG signal.
To date, no research has managed to successfully predict future AF episodes before
they occur with high accuracy (more than 80%).</p>

<hr>

<h2 id="motivation">Motivation</h2>

<p>Predicting future AF episodes will allow enrichment of trials of interventions to
prevent AF and better prepare for upcoming episodes. These interventions will help
to minimize the total length of an AF episode.
Such advancements may mitigate the patient’s risk for ischemic stroke and
potentially save many lives. They will also allow preparing for episodes during
surgery and reducing the number of medications patients with AF must take, thus
reducing the risk of side-effects.</p>

<h2 id="data">Data</h2>

<p>We used the MIT-BIH atrial database which contains 25 long-term ECG recordings of
human subjects with atrial fibrillation. Each recording is 10 hours in duration and
contains two ECG signals sampled at 250 Hz.
Data pre-processing:
    • Butterworth filter which effectively removes noise from the ECG signal.
    • Down-sampling from 250 Hz to 50Hz to prepare for utilizing multiple data-sets
    that have different frequencies.
    • Normalization of signals to values between 0 and 1 as different recordings have
    variations in their signals.
We created non-overlapping segments of 30-second ECG recordings using both ECG
channels. Each segment was tied to a variable that indicates if AF begins in the 30
minutes following the recording.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/Preprocessing-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/Preprocessing-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/Preprocessing-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/Preprocessing.png" title="Processing the ECG Signal">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Processing the ECG Signal.
</div>

<h2 id="model">Model</h2>

<p>A convolutional neural network (CNN) model designed for reading a 30-second ECG
recording and predicting if an AF event will occur in the following 30 minutes.
The model consists of the following major layers:
• A one-dimensional convolutional layer which generates feature maps from the
input signal.
• A pooling layer which reduces the size of the feature maps and creates a
summarized version of them.
• Fully connected layers which learn possible nonlinear functions of the feature
space.
The final layer consists of a SoftMax activation function that outputs the probability
that AF will occur in the next 30 minutes.</p>

<h2 id="results">Results</h2>

<p>The data (30 second non-overlapping ECG segments) was split randomly: 80% of it
was used for training the model and 20% was used for testing the model.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/Confusion-Matrix-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/Confusion-Matrix-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/Confusion-Matrix-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/Confusion-Matrix.png" title="Confusion Matrix">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    Successfully predicted 927 AF episodes.
</div>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    <source media="(max-width: 480px)" srcset="/assets/img/AUC-Graph-480.webp"></source>
    <source media="(max-width: 800px)" srcset="/assets/img/AUC-Graph-800.webp"></source>
    <source media="(max-width: 1400px)" srcset="/assets/img/AUC-Graph-1400.webp"></source>
    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/AUC-Graph.png" title="AUC Graph">

  </picture>

</figure>

    </div>
</div>
<div class="caption">
    AUC is the measure of the ability of a classifier to distinguish between results.
    Higher AUC indicates better performance of the model to distinguish between the
    positive and negative results.
</div>

<p>Evaluation methods:</p>

\[Accuracy = ((TP + TN) / (TP + TN + FP + FN)) = 87.9\%\]

\[Recall = ((TP) / (TP + FN)) = 74.4\%\]

\[Precision = ((TP) / (TP + FP)) = 72.1\%\]

\[Specifity = ((TN) / (TN + FP)) = 91.8\%\]

\[F1 Score = ((2*Precision*Recall) / (Precision + Recall))) = 73.2\%\]

<p>Recall is the most important evaluation method as it indicates the ability of the
model to correctly predict future AF episodes.</p>

<h2 id="discussion">Discussion</h2>

<p>We created a convolutional neural network that predicts if an AF will occur in the 30
minutes after a 30 second ECG recording with 87.9% accuracy. The results are
preliminary and further research must be completed to advance our findings and
produce better results.
For this purpose, we plan to utilize more data-sets, research different models, find
the most appropriate time frames for the prediction and the recording, and create a
patient-personalized model that performs better on predicting future AF episodes
for the same patient.
Future work should also include the use of data from wearable technologies such as
smartwatches that allow ECG recording.</p>


      </d-article>

      <d-appendix>
        <d-footnote-list></d-footnote-list>
        <d-citation-list></d-citation-list>
      </d-appendix>

    </div>

    <!-- Footer -->    <footer class="sticky-bottom mt-5">
      <div class="container">
        © Copyright 2023 Idan  Levy. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

      </div>
    </footer>

  </body>

  <d-bibliography src="/assets/bibliography/">
  </d-bibliography>

  <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

  <script src="/assets/js/distillpub/overrides.js"></script>

</html>
